@{
    ViewBag.Title = "Quản lý đơn hàng";
}
@model OrderSearchResult


<div class="box box-primary">
    <div class="box-body">
        <!--Form đầu vào tìm kiếm-->

        <div class="row container-fluid">
            <div class="col-sm-2">
                <select class="form-control" name="" id="ddlStatus">
                    <option value="0">-- Trạng thái --</option>
                    @foreach (var item in OrderDataService.ListStatusOrder())
                    {
                        <option value="@item.Status">@item.Description</option>

                    }

                </select>
            </div>
            <div class="col-sm-2">
                <input type="text" name="orderTime" id="txtorderTime" class="form-control daterange-picker" placeholder="" />
            </div>
            <div class="col-sm-8 input-group">
                <input type="text" name="searchValue" id="txtsearchValue"
                       class="form-control"
                       placeholder="Tìm kiếm theo tên khách hàng hoặc tên người giao hàng">
                <span class="input-group-btn">
                    <button type="button" id="btnSearchOrder" class="btn btn-flat btn-info">
                        <i class="fa fa-search"></i> Tìm kiếm
                    </button>
                </span>
            </div>
        </div>


        <!-- Kết quả tìm kiếm -->


        <div class="table-responsive" id="ListOrderPartial">
        </div>


    </div>
</div>
@section Scripts {
    <script>

        var PageSize = '@ViewBag.PageSize';
        var searchValue = '@ViewBag.SearchValue';
        var OrderTimeViewBag = '@ViewBag.OrderTime';
        var page = '@ViewBag.PageNumber';

        $(document).ready(function () {
            LoadData();

            $("#btnSearchOrder").click(function () {
                debugger;
                LoadData();
            });

        });

        function LoadData() {
            debugger;
            var searchValue = searchValue == "" || searchValue == null ? $("#txtsearchValue").val() : searchValue; //
            var orderTime = "";

            if (OrderTimeViewBag == "" || OrderTimeViewBag == null) 
            {
                orderTime = $("#txtorderTime").val();

            } else {

                orderTime = OrderTimeViewBag;
            }

            var param = {
                Status: $("#ddlStatus").val(),
                orderTime: orderTime,
                SearchValue: searchValue,
                Page: page
            };

            $.ajax({
                type: 'POST',
                url: "/Order/ListOrderPartial",
                data: param,
                async: true,
                dataType: "html",
                // dataType:"json",
                success: function (rs) {
                    $("#ListOrderPartial").html("");
                    $("#ListOrderPartial").html(rs);
                },
                error(rs) {
                    console.log(JSON.stringify(rs));
                }
            });
        }
    </script>
}